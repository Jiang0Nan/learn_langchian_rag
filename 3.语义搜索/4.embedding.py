# from langchain_huggingface import HuggingFaceEmbeddings
#
# model_kwargs = {"device": "cpu"}
# encode_kwargs = {"normalize_embeddings": True,"return_dense":True, "return_sparse":True, "return_colbert_vecs":True}
# hf = HuggingFaceEmbeddings(
#     model_name=r"D:\files\models\bge-m3",
#     cache_folder = r"D:\files\models\bge-m3",
#     model_kwargs=model_kwargs,# 文档编码参数
#     encode_kwargs=encode_kwargs,#查询编码参数（覆盖文档的部分配置）
#     show_progress = True,
# )
#
# embedding = hf.embed_query("hi this is harrison")
# print(embedding)
#
#
# FlagEmbedding 支持bge模型，其中FlagModel是通用的，BGEM3FlagModel是针对bge-m3的
from FlagEmbedding import BGEM3FlagModel

model = BGEM3FlagModel(model_name_or_path = r"D:\files\models\bge-m3", use_fp16=False)

passage = str("'药品说明书 ': 'text': '非诺贝特胶囊[188249]说明书', 'page_idx': -1 ,'【药品名称】': 'type': 'text', 'text': '通用名称：非诺贝特胶囊商品名称：力平之/LIPANTHYL英文名称：Fenofibrate Capsules汉语拼音：Feinuobeite Jiaonang', 'page_idx': 0}], '【成份】': [{'type': 'text', 'text': '化学名称为：2-[4-(4-氯苯甲酰基)苯氧基]-2-甲基-丙酸甲基乙酯', 'page_idx': 0}, {'type': 'text', 'text': '化学结构式：', 'page_idx': 0}, {'type': 'text', 'text': '分子式： $\\mathrm { C } _ { 2 0 } \\mathrm { H } _ { 2 1 } \\mathrm { C l } 0 _ { 4 }$ 分子量：360.84', 'page_idx': 0}]}, {'【性状】': [{'type': 'text', 'text': '本品为硬胶囊，内容物为白色粉末。', 'page_idx': 0}], '【适应症】': [{'type': 'text', 'text': '供成人使用', 'page_idx': 0}, {'type': 'text', 'text': '用于治疗成人饮食控制疗法效果不理想的高胆固醇血症(IIa型)，内源性高甘油三酯血症，单纯型(IV型)和混合型(IIb和II型)。特别是饮食控制后血中胆固醇仍持续升高，或是有其他并发的危险因素时。', 'page_idx': 0}, {'type': 'text', 'text': '在服药过程中应继续控制饮食。', 'page_idx': 0}, {'type': 'text', 'text': '目前，尚无长期临床对照研究证明非诺贝特在动脉粥样硬化并发症一级和二级预防方面的有效性。  \n尚未证明非诺贝特能降低2型糖尿病患者的冠心病发病率和死亡。', 'page_idx': 0}]}, {'【规格】': [{'type': 'text', 'text': '200mg【用法用量】', 'page_idx': 0}, {'type': 'text', 'text': '配合饮食控制，该药可长期服用，并应定期监测疗效。', 'page_idx': 0}, {'type': 'text', 'text': '每日服用一粒，与餐同服。', 'page_idx': 0}, {'type': 'text', 'text': '-当胆固醇的水平正常时，建议减少剂量。', 'page_idx': 0}, {'type': 'text', 'text': '-肾功能受损患者：轻中度肾功能受损患者建议从较小的起始剂量开始使用，然后根据对肾功能和血脂的影响，进行剂量调整。', 'page_idx': 0}]}, {'【不良反应】': [{'type': 'text', 'text': '在治疗过程中最常报告的药物不良反应为消化、胃肠道不适。', 'page_idx': 0}, {'type': 'text', 'text': '在安慰剂对照临床试验过程中 $\\scriptstyle ( \\ n = 2 3 4 4 )$ 和上市后(未知频率)，发现了下列伴有如下指定频率的不良反', 'page_idx': 0}, {'type': 'text', 'text': '应：', 'page_idx': 1}, {'type': 'table', 'img_path': 'images/a6fef0e33a0c34291cf9c162a57081455b4a69966cbf91ddf2af710a79492b05.jpg', 'table_caption': [], 'table_footnote': [], 'table_body': '<table><tr><td colspan='8'></td></tr><tr><td>MedDra系统 器官分类</td><td></td><td>&gt;1/100, &lt;1/10</td><td>不常见 &gt;1/1,000, &lt;1/100 acare</td><td>罕见 &gt;10,000, &lt;1/1,000</td><td>极罕见 &lt;1/10,0 00包括 单独报 告</td><td>上市后观察到 未知频率(无法 根据现有数据 估算）</td></tr><tr><td>血液淋巴系</td><td></td><td></td><td></td><td>血红白和白</td><td></td><td></td></tr><tr><td>免疫系统疾病</td><td></td><td></td><td>头痛</td><td>过敏</td><td></td><td></td></tr><tr><td>神经系统疾病 血管疾病</td><td></td><td></td><td>血栓栓塞(肺</td><td></td><td></td><td>疲劳</td></tr><tr><td></td><td></td><td></td><td>栓塞、深静 脉血栓)**</td><td></td><td></td><td></td></tr><tr><td>呼吸、胸和纵 膈疾病</td><td></td><td></td><td>are</td><td></td><td>a</td><td>间质性肺病</td></tr><tr><td>胃肠道疾病</td><td></td><td>胃肠道症状和指 征(腹痛、恶心 呕吐、腹泻、 胃肠胀气)</td><td></td><td>iphy</td><td></td><td></td></tr><tr><td>肝胆疾病</td><td></td><td>血清转氨酶升高 (见[注意事项])</td><td>胆结石(见 [注意事项])</td><td>肝炎</td><td></td><td>黄疸、胆结石 并发症（例如胆 囊炎、胆管炎 胆绞痛)</td></tr><tr><td>皮肤和皮下组 织疾病 ipharma 杭州</td><td></td><td>ipk</td><td>皮肤过敏(例 如：皮疹、 瘙痒症、荨 麻疹)</td><td>脱发 光敏反应</td><td></td><td>重度影响皮肤 的反应(例如 ：多形性红斑 史蒂文斯-约 逊 死溶解)</td></tr><tr><td>肌肉骨骼、结 缔组织和骨病 症</td><td></td><td></td><td>肌障碍(例如 肌痛、肌 炎、肌肉痉 挛和无力)</td><td></td><td></td><td>横纹肌溶解</td></tr><tr><td>生殖系统和乳 腺疾病 实验室检查</td><td></td><td></td><td>性功能障碍</td><td></td><td></td><td></td></tr><tr><td>pharma</td><td>血同型半胱氨酸水平升高</td><td></td><td>血清肌酐增 加 macare 州逸曜</td><td>血尿素增加</td><td>杭州</td><td></td></tr></table>', 'page_idx': 1}, {'type': 'text', 'text': '\\*FIELD研究是在9795名2型糖尿病患者中开展的一项随机安慰剂对照的研究。在研究中观察到，服用', 'page_idx': 1}, {'type': 'text', 'text': '非诺贝特的患者较服用安慰剂的患者，发生胰腺炎的病例数有统计学意义的显著增加(0.8%： 0.5%；p=0.031)。', 'page_idx': 2}, {'type': 'text', 'text': '\\*\\*肺栓塞发病率有统计学意义的显著增加(安慰剂组 $0 . 7 \\%$ ：非诺贝特组1.1%；p=0.022)，深静脉血栓发病率有统计学无显著意义的增加(安慰剂组1.0% (48/4900患者)：非诺贝特组1.4% (67/4895患者)；p=0.074)。 ca', 'page_idx': 2}, {'type': 'text', 'text': '\\*\\*\\*非诺贝特治疗组患者的血同型半胱氨酸水平平均增加6.5μ mol/L，且在治疗停止后可恢复至正常水平。静脉血栓事件风险增加可能与同型半胱氨酸酸水平升高相关。尚不清楚该结果的临床意义。', 'page_idx': 2}]}, {'【禁忌】': [{'type': 'text', 'text': '在下列情况中，此药物禁止使用：', 'page_idx': 2}, {'type': 'text', 'text': '-对非诺贝特或本品辅料过敏者；', 'page_idx': 2}, {'type': 'text', 'text': '由于存在过敏反应的风险，不应给对花生或花生油或大豆卵磷脂或相关产品过敏的患者服用；', 'page_idx': 2}, {'type': 'text', 'text': '-肝功能不全者，包括原发性胆汁性肝硬化，以及不明原因持续性肝功能异常患者；', 'page_idx': 2}, {'type': 'text', 'text': '-严重肾功能受损患者，包括接受透析的患者；', 'page_idx': 2}, {'type': 'text', 'text': '-已知在治疗过程中使用非诺贝特或与之结构相似的药物，尤其是酮洛芬时，会出现光毒性或光敏反应；', 'page_idx': 2}, {'type': 'text', 'text': '-已知有胆囊疾病患者；', 'page_idx': 2}, {'type': 'text', 'text': '-慢性或急性胰腺炎，重症高甘油三酯血症引起的急性胰腺炎除外；', 'page_idx': 2}, {'type': 'text', 'text': '-孕妇与哺乳期妇女；', 'page_idx': 2}, {'type': 'text', 'text': '-与其他贝特类药物合用(详见[药物相互作用])。', 'page_idx': 2}]}, {'【注意事项】': [{'type': 'text', 'text': '警告', 'page_idx': 2}, {'type': 'text', 'text': '骨骼肌：曾有使用贝特类和其他降血脂药发生肌毒性，包括罕见伴随或不伴随肾功能衰竭的横纹肌溶解病例的报告。如果有低蛋白血症以及之前曾有肾功能不全，这种疾病的发生率会增加。有肌病和/或横纹肌溶解易感因素(包括年龄大于70岁，有遗传性肌病的个人或家族史、肾功能受损、糖尿病、甲状腺功能减退、以及大量摄入酒精)的患者，发生横纹肌溶解的风险可能增高。 $1 0 0 - 1 0 0 0$ 对于出现弥漫性肌肉痛、肌炎、肌痛性肌肉痉挛、肌无力、伴或不伴肌源性CPK明显增高(超过正常5倍以上)的患者，应怀疑是否出现肌毒性，对这样的病例，应停止使用非诺贝特。使用非诺贝特的患者出现上述症状应当立即报告医生。观察性研究发现，当贝特类降脂药，特别是吉非罗齐，与H MG-CoA还原酶抑制剂(他汀类)联合使用时横纹肌溶解的风险增高。', 'page_idx': 2}, {'type': 'text', 'text': '由于处方中乳糖的存在，本品禁用于患有先天性半乳糖症，葡萄糖或半乳糖吸收障碍综合征，或乳糖酶缺乏症患者。 cal car', 'page_idx': 2}, {'type': 'text', 'text': '使用注意事项', 'page_idx': 2}, {'type': 'text', 'text': '-如果在服用几个月(3-6个月)后，血脂未得到有效的改善，应考虑补充治疗或采用其他方法治疗。', 'page_idx': 2}, {'type': 'text', 'text': '-肝功能：与使用其他降脂药物一样，一些病人使用非诺贝特后可能引起转氨酶(AST或ALT)升高，通常为一过性的、轻微或无症状的。有报告非诺贝特数周至数年的治疗中发生的肝细胞性、慢性活动性、胆汁淤积性肝炎，极为罕见有慢性活动性肝炎相关的肝硬化。建议：', 'page_idx': 2}, {'type': 'text', 'text': '●在治疗的最初12个月，每隔3个月检查转氨酶水平；', 'page_idx': 3}, {'type': 'text', 'text': '●应特别注意转氨酶升高的患者，当AST和ALT升高至正常值的3倍以上时，应停止治疗；', 'page_idx': 3}, {'type': 'text', 'text': '●如果发生提示肝炎的症状(例如：黄疸、瘙痒症)，而且实验室检查确认肝炎诊断，应停止非诺贝特治疗。', 'page_idx': 3}, {'type': 'text', 'text': '-肾功能：有非诺贝特治疗后血清肌酐升高的报告，停药后趋向于回复到基线水平。肌酐升高的临床意义尚不清楚。对于原有肾功能受损患者、老年和糖尿病患者，建议定期监测肾功能。', 'page_idx': 3}, {'type': 'text', 'text': '-胰腺炎：在接受非诺贝特治疗的病人中有报道胰腺炎的病例。这可能是由于对严重高甘油三酯血症的病人缺乏疗效，或者由于药物的直接作用，或者继发于胆结石形成或者胆汁淤积阻塞胆管。', 'page_idx': 3}, {'type': 'text', 'text': '-胆石症：非诺贝特可能增加胆固醇的分泌进入胆汁，可能导致胆石症。如果怀疑胆石症，应做胆囊检查。如果确诊胆石症，应当停止使用非诺贝特。 ha', 'page_idx': 3}, {'type': 'text', 'text': '-非诺贝特与香豆素类口服抗凝剂合用时，可能会增强后者的抗凝效应。为了避免出血并发症，应密切监测PT和INR，并可能需要调整口服抗凝剂的剂量(见药物相互作用)。', 'page_idx': 3}, {'type': 'text', 'text': '-在考虑非诺贝特的治疗之前，应对高脂血症的继发原因进行充治疗，例如：未控制的2型糖尿病、甲状腺功能减退、肾病综合症、蛋白异常血症、阻塞性肝病或酗酒。药物治疗有关的继发性高胆固醇血症见于：利尿剂、β 受体阻滞剂、雌激素、孕激素、复方口服避孕药、免疫抑制剂和蛋白抑制剂。在这些情况下，应该查明高脂血症是原发性还是继发性(血脂水平的升高可能是由口服雌激素造成的)。 2', 'page_idx': 3}, {'type': 'text', 'text': '-血液学改变：非诺贝特治疗的患者中观察到轻中度的血红蛋白、红细胞压积，以及白细胞的下降，然而通常在长期治疗过程中维持稳定的水平。有过非诺贝特治疗的患者发生血小板减少症和粒细胞减少症的报告。建议在非诺贝特治疗的最初12个月定期监测血液红细胞、白细胞计数。', 'page_idx': 3}, {'type': 'text', 'text': '-过敏反应：有过非诺贝特治疗的患者发生Stevens-Johnson综合症和需要住院使用皮质激素治疗的毒性表皮坏死的病例报告。报道风疹的发生率在非诺贝特治疗组与安慰剂组分别为1.1%和0%；潮红的发生率在非诺贝特治疗组与安慰剂组分别为1.4%和0.8%。', 'page_idx': 3}, {'type': 'text', 'text': '-深静脉血栓性疾病：FIELD是在9795名2型糖尿病患者中开展的一项随机安慰剂对照的研究。研究中，4900例患者入组安慰剂组，而4895例患者入组非诺贝特组。肺栓塞发病率在非诺贝特组(1.1%)高于安慰剂组(0.7%)，p=0.022。深静脉血栓发病率分别为非诺贝特组1.4%，安慰剂组1.0%，p=0.074。', 'page_idx': 3}]}, {'【孕妇和哺乳期妇女用药】': [{'type': 'text', 'text': '生育力', 'page_idx': 3}, {'type': 'text', 'text': '在动物试验中观察到非诺贝特对生育力的影响是可逆的。尚无本品影响生育力的临床数据。', 'page_idx': 3}, {'type': 'text', 'text': '孕期', 'page_idx': 3}, {'type': 'text', 'text': '-孕妇使用非诺贝特的数据尚不充分。动物试验结果显示未见有致畸作用。', 'page_idx': 3}, {'type': 'text', 'text': '-到目前为止，临床尚未出现致畸和胚胎毒性。但对孕期使用非诺贝特的跟踪不足以排除任何危险，故一般孕妇应禁用。', 'page_idx': 3}, {'type': 'text', 'text': '-贝特类药物不用于孕妇，但通过饮食控制不能有效降低高甘油三酯血症 $( \\mathrm { { > } 1 0 g / L ) }$ 而增加母体患急性胰腺炎危险的情况时除外。', 'page_idx': 3}, {'type': 'text', 'text': '哺乳期', 'page_idx': 4}, {'type': 'text', 'text': '目前尚无非诺贝特和/其代谢产物是否可进入母乳的资料，不能排除对母乳喂养的婴儿产生风险。因此哺乳期不建议使用本品。', 'page_idx': 4}]}, {'【儿童用药】': [{'type': 'text', 'text': '尚未确定非诺贝特在儿童和18岁以下青少年中的安全性和疗效。目前尚无相关数据。因此不建议18岁以下的患者使用本品。', 'page_idx': 4}], '【老年用药】': [{'type': 'text', 'text': '老年人的剂量选择取决于肾功能状态。肾功能正常的老年人通常不需要调整剂量。如有肾功能受损可以减少剂量。使用非诺贝特的老年患者可以进行肾功能的监测。', 'page_idx': 4}]}, {'【药物相互作用】': [{'type': 'text', 'text': '禁止合并使用其他贝特类药物：增加不良反应如横纹肌溶解症和两种分子间的药效拮抗作用的发生率。', 'page_idx': 4}, {'type': 'text', 'text': '观察性研究发现，当贝特类降脂药，特别是吉非罗齐，与H MG-CoA还原酶抑制剂(他汀类)联合使用时横纹肌溶解的风险增高。除非调脂治疗的获益可能超过其风险，应避免联合使用贝特类与他汀类，在原有肌肉疾病的情况下尤其如此。若经评估后确定获益大于其风险，在无任何肌肉疾病史的混合型血脂异常伴心血管高危因素的严重患者才能同时处方非诺贝特与H MG-CoA还原酶抑制剂，并应密切监测患者的潜在肌肉毒性。', 'page_idx': 4}, {'type': 'text', 'text': '香豆素类口服抗凝剂：非诺贝特与香豆素类口服抗凝剂合用时，非诺贝特能够与血浆白蛋白结合紧密，从蛋白结合部位置换出抗凝剂，会增强后者的抗凝效应，使PT和INR进一步延长。为了避免出血并发症，合用非诺贝特时，应当减低口服抗凝剂的剂量，更频繁地监测PT和INR直至达到稳定。', 'page_idx': 4}, {'type': 'text', 'text': '免疫抑制剂：免疫抑制剂例如环孢素、他克莫司具有肾毒性，会减低肌酐清除率并升高血清肌酐。由于贝特类包括非诺贝特主要以肾脏分泌为主要排泄途径，免疫抑制剂与非诺贝特的相互作用可能导致肾功能的恶化。应当慎重权衡联合使用非诺贝特与免疫抑制剂的风险和获益；如果必需使用则应当使用最小有效剂量，并监测肾功能。', 'page_idx': 4}, {'type': 'text', 'text': '胆酸结合剂：胆酸结合剂会与同时服用的药物结合，因此，应当至少在服用胆酸结合剂前1小时或者后4-6小时在服用非诺贝特，以避免阻碍非诺贝特的吸收。', 'page_idx': 4}, {'type': 'text', 'text': '秋水仙碱：有报告非诺贝特合用秋水仙碱发生包括横纹肌溶解在内的肌病，两者合用要谨慎。', 'page_idx': 4}, {'type': 'text', 'text': '格列酮类：在合用非诺贝特和格列酮类的过程中，报告了可逆性ΗDL-胆固醇反常降低的一些病例。因此，如果在其中-种药物基础上加用另一种药物，建议对HDL-胆固醇进行监测，并在HDL-胆固醇太低时停止其中一种治疗。 $\\times 3 = 1 8 0 ( c m )$ ', 'page_idx': 4}, {'type': 'text', 'text': '细胞色素P450酶：', 'page_idx': 4}, {'type': 'text', 'text': '以人肝肝微粒体进行的体外研究表明：非诺贝特和非诺贝特酸不是细胞色素(CYP)P450亚型CYP3A4、Cyp2D6、CYP2E1、或CYP1A2的抑制剂。在治疗浓度下，它们是CYP2C19和CYP2A6的弱抑制剂，是CYP2C9的弱至中度抑制剂。  \n对于合用非诺贝特和经CYP2C19、CYP2A6、特别是CYP2C9代谢的治疗指数窄的药物的患者，应对其进行谨慎监测，如有必要，建议对这些药物进行剂量调整。', 'page_idx': 4}]}, {'【药物过量】': [{'type': 'text', 'text': '非诺贝特过量没有特殊治疗，可给予对症治疗。如果发生过量，给予一般支持性的护理，包括监测生命体征，观察临床状况。必要时给予催吐或者洗胃排出未被吸收的药物，要注意维持呼吸道通畅', 'page_idx': 4}, {'type': 'text', 'text': '。因为非诺贝特酸与血浆白蛋白结合紧密，血液透析不能清除非诺贝特酸，过量时不应考虑使用血透。', 'page_idx': 5}]}, {'【药理毒理】': [{'type': 'text', 'text': '药理作用', 'page_idx': 6}, {'type': 'text', 'text': '非诺贝特可降低血清胆固醇20-25%，降低甘油三酯 $4 0 - 5 0 \\%$ 。', 'page_idx': 6}, {'type': 'text', 'text': '-胆固醇的降低是通过降低低密度动脈粥样化成分(VILDL和LDL)，并且通过降低总胆固醇/HDL胆固醇比率取得的(该比率在动脉粥样化高脂血症中升高)，从而改善了血浆中胆固醇的分布。', 'page_idx': 6}, {'type': 'text', 'text': '-高胆固醇和动脉粥样硬化的关系，以及动脉硬化与冠状动脉疾病危险的关系已得到证实。低水平的HDL可增加冠状动脉疾病危险。甘油三酯升高可增加心血管疾病危险，但还不能确定这种关系是独立存在的。另外，甘油三酯可能不仅与动脉粥样化有关，而且与血栓形成有关。', 'page_idx': 7}, {'type': 'text', 'text': '-通过有效延长治疗期(显著降低胆固醇)，血管外胆固醇的沉积(腱和结节黄瘤)能够有明显的消退，甚至完全消除。 can', 'page_idx': 7}, {'type': 'text', 'text': '-在高脂血症病人中非诺贝特有利尿酸的作用，可使血浆中尿酸平均降低25%。', 'page_idx': 7}, {'type': 'text', 'text': '-非诺贝特治疗增加apoA1、降低apoB，从而改善apoA1/apoB比率，该比值被认为是动脉粥样化的标志。', 'page_idx': 7}, {'type': 'text', 'text': '-动物研究和人体临床研究表明，非诺贝特具有抗血小板凝集的作用，该作用是通过降低ADP、花生四烯酸和肾上腺素所致的凝集反应而实现的。', 'page_idx': 7}, {'type': 'text', 'text': '-非诺贝特通过激活PPARα(过氧化物酶增殖体激活受体α），激活脂蛋白脂酶和减少载脂蛋白CⅢ合成，使血浆中脂蛋白颗粒降解和甘油三酯清除明显增加。PPARα 的激活也导致载脂蛋白AI和AⅡI合成的增加。', 'page_idx': 7}, {'type': 'text', 'text': '毒理研究遗传毒性：', 'page_idx': 7}, {'type': 'text', 'text': '非诺贝特A mes试验、小鼠淋巴瘤试验、染色体畸变试验以及大鼠原代肝细胞的程序外DNA合成试验结果均为阴性。', 'page_idx': 7}, {'type': 'text', 'text': '生殖毒性：', 'page_idx': 7}, {'type': 'text', 'text': '雌性大鼠从交配前15天开始，雄性大鼠从交配前61天开始，至交配结束，经口给予非诺贝特达300m/kg/天，按体表面积换算，相当于临床拟用最大剂量(MRH D)的10倍时，未见对生育力的影响；雌性大鼠在15mg/kg/天剂量时，按体表面积换算，相当于MRHD的0.3倍，可见母体毒性。', 'page_idx': 7}, {'type': 'text', 'text': '大鼠妊娠第6-15天经口给予非诺贝特，14mg/kg/天剂量时，按体表面积换算，低于MRHD，未见对胚胎发育的影响；127、361mg/kg/天剂量时，可见母性毒性。', 'page_idx': 7}, {'type': 'text', 'text': '兔妊娠第6-18天经口给予非诺贝特，15mg/kg/天剂量时，按体表面积换算，低于MRHD，未见对胚胎发育的影响；150mgkg/天剂量时，按体表面积换算，约为MRHD的10倍，可见流产。', 'page_idx': 7}, {'type': 'text', 'text': '大鼠妊娠第15天到哺乳第21天经口给予非诺贝特15、75、300mg/kg/天，按体表面积换算，低于MRHD时，可见母体毒性。', 'page_idx': 7}, {'type': 'text', 'text': '犬连续3个月经口给予非诺贝特酸(非诺贝特的人体主要代谢产物)25、50、75mg/kg/天，可见生殖系统可逆性变化，包括雄性睾丸空泡化和精子生成功能降低，罐性卵巢不成熟(黄体缺失)。 $\\sim$ ', 'page_idx': 7}, {'type': 'text', 'text': '致癌性：', 'text_level': 1, 'page_idx': 7}, {'type': 'text', 'text': 'W istar大鼠连续两年经口给予非诺贝特10、45、200mg/kg(按体表面积换算，分别约为MRHD的0.3、1、6倍)，剂量为MRHD的6倍时，可见所有动物肝脏肿瘤发生率增加，雄性动物胰腺肿瘤和良性睾丸间质细胞瘤发生率增加；为MRHD的1倍、6倍时，可见雄性胰腺肿瘤发生率增加。SD大鼠两年致癌性试验中经口给予非诺贝特10、600mg/kg/天(按体表面积换算，为MRHD的0.3倍和2倍)，可见所有动物胰腺腺泡细胞瘤发生率增加，为MRHD的2倍时，可见雄性动物睾丸间质细胞瘤发生率增加。', 'page_idx': 7}, {'type': 'text', 'text': '小鼠连续21个月经口给予非诺贝特10、45、200mg/kg/天(按体表面积换算，分别约为MRHD的0.2倍、1倍、3倍)，其中为MRHD的3倍时，可见所有动物肝脏肿瘤发生率增加。小鼠连续18个月经口给予非诺贝特，按体表面积换算，为MRHD的3倍时，可见雄性动物肝脏肿瘤发生率增加和雌性动物肝脏腺瘤发生率增加。', 'page_idx': 7}, {'type': 'text', 'text': '电镜结果显示，大鼠给予非诺贝特后可见过氧化物酶增殖，尚未有充分的研究对人体的影响，但其他贝特类药物给药前后，临床肝脏活检标本未见氧化物酶形态学和数量上的变化。', 'page_idx': 8}]}, {'【药代动力学】': [{'type': 'text', 'text': '非诺贝特在血浆中未发现原型存在，吸收进入体内后，在肝脏迅速被酯酶水解成为活性代谢产物，主要活性代谢产物为非诺贝特酸。', 'page_idx': 8}, {'type': 'text', 'text': '通常服药后5小时可达最大血浆浓度。每日服用一粒力平之微粒化非诺贝特胶囊后的平均血浆浓度约为15μg/ml。', 'page_idx': 8}, {'type': 'text', 'text': '同一病人连续治疗，其血药浓度水平是稳定的。', 'page_idx': 8}, {'type': 'text', 'text': '非诺贝特酸与血浆白蛋白结合紧密，可从蛋白结合部位取代维生素K拮抗剂，加强抗凝效果(详见[药物相互作用])。', 'page_idx': 8}, {'type': 'text', 'text': '非诺贝特酸在血液中消除半衰期约为20小时。', 'page_idx': 8}, {'type': 'text', 'text': '该药主要从尿中排泄，几乎所有产物在6天内从体内排除。', 'page_idx': 8}, {'type': 'text', 'text': '非诺贝特主要以非诺贝特酸的形式消除，还有其葡糖苷酸衍生物。', 'page_idx': 8}, {'type': 'text', 'text': '单剂量和多剂量给药药代动力学研究表明，非诺贝特无蓄积效应。', 'page_idx': 8}, {'type': 'text', 'text': '血液透析不能清除非诺贝特酸。', 'page_idx': 8}, {'type': 'text', 'text': '肾功能受损患者：比较了轻中重度肾功能受损患者与健康人的非诺贝特药代动力学特征。重度肾功能受损患者(肌酐清除率≤30ml/min或估算的肾小球滤过率[eGFR]<30ml1/min/1.73m)的非诺贝特酸的暴露量增高了2.7倍；并且长期给药后的蓄积增加。', 'page_idx': 8}, {'type': 'text', 'text': '轻中度肾功能受损患者(肌酐清除率30-80ml/min或eGFR30-59ml/min/1.73m²)的非诺贝酸的暴露量没有显著变化，但非诺贝酸的半衰期延长。因此，重度肾功能受损患者应当避免使用非诺贝特，轻中度肾功能受损患者使用非诺贝特应当减低剂量。', 'page_idx': 8}, {'type': 'text', 'text': '肝功能受损患者：尚未在肝功能受损患者进行药代动力学研究。', 'page_idx': 8}]}, {'【贮藏】': [{'type': 'text', 'text': '干燥处保存。', 'page_idx': 8}], '【包装】': [{'type': 'text', 'text': '10粒/盒，铝塑泡罩包装。', 'page_idx': 8}], '【有效期】': [{'type': 'text', 'text': '36个月', 'page_idx': 8}], '【执行标准】': [{'type': 'text', 'text': '进口药品注册标准：JX20090069', 'page_idx': 8}], '【批准文号】': [{'type': 'text', 'text': '进口药品注册证号：H20181239 ', 'page_idx': 8, '【生产企业】': 'type': 'text', 'text': '公司名称：RECIPHARMFONTAINE', 'page_idx': 9")
passage = passage.replace('{','')
passage = passage.replace('[','')
passage = passage.replace(']','')
passage = passage.replace('}','')
output = model.encode(passage,return_dense=True, return_sparse=True, return_colbert_vecs=True)
print(output)
print(output.keys())


# from langchain_ollama import OllamaEmbeddings # 失败了，估计是因为ollama 版本问题
#
# text = [
#     {
#         'docnm_kwd': 'D:\\projects\\learn_langchain_rag\\langchain\\2.消息，模板，chatModel\\file\\drug description\\非奈利酮片[190125,190124].pdf',
#         'title_tks': 'd project learn _ langchain _ rag langchain 2 消息 模板 chatmodel file drug descript 非 奈 利 酮 片 190125 190124',
#         'title_sm_tks': 'd project learn _ langchain _ rag langchain 2 消息 模板 chatmodel file drug descript 非 奈 利 酮 片 190125 190124',
#         'content_with_weight': '图2：FIGARO-DKD研究中至首次发生肾衰竭、eGFR较基线值下降≥40%持续至少4周或肾性死亡的\n至首次发生事件的时间（月）\n图1：FIDELIO-DKD研究中至首次发生肾衰竭、eGFR较基线值下降≥40%持续至少4周或肾性死亡的\n0.4-\n计划治疗\n1.非奈利酮（N=2833）\n2.安慰剂（N=2841)\n0.3-\n累积发生率\n0.2-\n0.1-\n0-\n0\n6\n12\n18\n24\n30\n36\n42',
#         'content_ltks': '图 2 figaro dkd 研究 中至 首次 发生 肾衰竭 egfr 较 基线 值 下降 40 持续 至少 4 周 或 肾 性 死亡 的 至 首次 发生 事件 的 时间 月 图 1 fidelio dkd 研究 中至 首次 发生 肾衰竭 egfr 较 基线 值 下降 40 持续 至少 4 周 或 肾 性 死亡 的 0 4 计划 治疗 1 非 奈 利 酮 n 2833 2 安慰剂 n 2841 0 3 累积 发生率 02 01 0 0 6 12 18 24 30 36 42',
#         'content_sm_ltks': '图 2 figaro dkd 研究 中至 首次 发生 肾 衰竭 egfr 较 基线 值 下降 40 持续 至少 4 周 或 肾 性 死亡 的 至 首次 发生 事件 的 时间 月 图 1 fidelio dkd 研究 中至 首次 发生 肾 衰竭 egfr 较 基线 值 下降 40 持续 至少 4 周 或 肾 性 死亡 的 0 4 计划 治疗 1 非 奈 利 酮 n 2833 2 安慰 剂 n 2841 0 3 累积 发生 率 02 01 0 0 6 12 18 24 30 36 42',
#         'doc_type_kwd': 'image', 'page_num_int': [9, 10], 'position_int': [(9, 35, 554, 774, 789), (10, 92, 525, 41, 358)], 'top_int': [774, 41]
#     },
#     {
#         'docnm_kwd': 'D:\\projects\\learn_langchain_rag\\langchain\\2.消息，模板，chatModel\\file\\drug description\\非奈利酮片[190125,190124].pdf',
#         'title_tks': 'd project learn _ langchain _ rag langchain 2 消息 模板 chatmodel file drug descript 非 奈 利 酮 片 190125 190124',
#         'title_sm_tks': 'd project learn _ langchain _ rag langchain 2 消息 模板 chatmodel file drug descript 非 奈 利 酮 片 190125 190124',
#         'content_with_weight': '0.20\n计划治疗\n1.非奈利酮（N=3686\n） 2.安慰剂（N=3666\n0.15-\n发生\n0.10-\n累积\n0.05-\n12\n18\n24\n30\n36\n42\n48\n54\n至首次发生事件的时间（月）',
#         'content_ltks': '0 20 计划 治疗 1 非 奈 利 酮 n 3686 2 安慰剂 n 3666 0 15 发生 0 10 累积 0 05 12 18 24 30 36 42 48 54 至 首次 发生 事件 的 时间 月',
#         'content_sm_ltks': '0 20 计划 治疗 1 非 奈 利 酮 n 3686 2 安慰 剂 n 3666 0 15 发生 0 10 累积 0 05 12 18 24 30 36 42 48 54 至 首次 发生 事件 的 时间 月',
#     },
#     ]
# title ,contents = [],[]
# for d in text:
#     title.append(d.get('docnm_kwd','Title'))
#     contents.append(d.get('content_with_weight'))
# embedding = OllamaEmbeddings(model='bge-m3:latest',base_url='http://localhost:11434')
# # embedding.embed_query(contents)
# embedding.embed_documents(contents)

